<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KLORIVA CRM - Login</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="min-h-screen flex items-center justify-center overflow-hidden relative">
  <!-- Enhanced Video Background -->
  <div class="fixed inset-0 z-0">
    <video autoplay muted loop playsinline preload="auto" class="absolute min-w-full min-h-full object-cover">
      <source src="videos/background.mp4" type="video/mp4">
      <source src="videos/background.webm" type="video/webm">
      Your browser does not support HTML5 video.
    </video>
    <div class="absolute inset-0 bg-black/40"></div>
  </div>
    <div class="absolute inset-0 bg-black/10 animate-[pulse_20s_infinite] pointer-events-none"></div>
    <div class="w-full max-w-md p-8 space-y-8 bg-white rounded-lg shadow-lg form-container transition-all duration-500 hover:scale-[1.02] hover:shadow-xl hover:ring-2 hover:ring-green-500/20 animate-[fadeIn_0.5s_ease-in-out] relative overflow-hidden group">
        <div class="absolute inset-0 bg-green-500/5 opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
        <div class="absolute -inset-2 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-green-500/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-700 -z-10"></div>
        <div class="text-center">
            <h2 class="text-3xl font-bold text-gray-900">Selamat Datang</h2>
            <p class="mt-2 text-gray-600">Silakan login atau daftar untuk melanjutkan</p>
        </div>

        <div class="flex border-b border-gray-300 relative">
            <button id="loginTab" class="flex-1 py-2 font-medium text-center text-gray-800 tab-button relative group">
                <span>Login</span>
                <div class="absolute bottom-0 left-0 w-full h-0.5 bg-green-600 transform origin-left transition-all duration-300 scale-x-100"></div>
            </button>
            <button id="registerTab" class="flex-1 py-2 font-medium text-center text-gray-500 tab-button relative group">
                <span>Daftar</span>
                <div class="absolute bottom-0 left-0 w-full h-0.5 bg-green-600 transform origin-left transition-all duration-300 scale-x-0 group-hover:scale-x-100"></div>
            </button>
        </div>

        <!-- Form Login -->
        <form id="loginForm" class="space-y-6" onsubmit="handleLogin(event)">
            <div class="relative">
                <input type="email" id="loginEmail" required 
                       class="peer mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 placeholder-transparent"
                       placeholder="Email">
                <label for="loginEmail" 
                       class="absolute left-3 -top-2.5 px-1 bg-white text-green-600 text-xs transition-all duration-200 peer-placeholder-shown:text-sm peer-placeholder-shown:text-gray-500 peer-placeholder-shown:top-3 peer-focus:-top-2.5 peer-focus:text-green-600 peer-focus:text-xs">
                    Email
                </label>
            </div>
            <div class="relative">
                <input type="password" id="loginPassword" required 
                       class="peer mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 placeholder-transparent"
                       placeholder="Password">
                <label for="loginPassword" 
                       class="absolute left-3 -top-2.5 px-1 bg-white text-green-600 text-xs transition-all duration-200 peer-placeholder-shown:text-sm peer-placeholder-shown:text-gray-500 peer-placeholder-shown:top-3 peer-focus:-top-2.5 peer-focus:text-green-600 peer-focus:text-xs">
                    Password
                </label>
            </div>
            <div>
                <button type="submit" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white btn-primary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 relative overflow-hidden group transition-all duration-300 hover:shadow-lg hover:scale-[1.02] active:scale-[0.98]">
                    <span class="relative z-10 flex items-center">
                        <span class="transition-all duration-300 group-hover:pr-2">Masuk</span>
                        <i class="fas fa-arrow-right ml-0 opacity-0 transform -translate-x-2 transition-all duration-300 group-hover:opacity-100 group-hover:ml-2 group-hover:translate-x-0"></i>
                    </span>
                    <span class="absolute inset-0 bg-white opacity-0 group-hover:opacity-10 transition-opacity duration-500"></span>
                </button>
            </div>
        </form>

        <!-- Form Daftar -->
        <form id="registerForm" class="hidden space-y-6">
            <div class="relative">
                <input type="text" id="regName" required
                       class="peer mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 placeholder-transparent"
                       placeholder="Nama Lengkap">
                <label for="regName" 
                       class="absolute left-3 -top-2.5 px-1 bg-white text-green-600 text-xs transition-all duration-200 peer-placeholder-shown:text-sm peer-placeholder-shown:text-gray-500 peer-placeholder-shown:top-3 peer-focus:-top-2.5 peer-focus:text-green-600 peer-focus:text-xs">
                    Nama Lengkap
                </label>
            </div>
            <div class="relative">
                <input type="email" id="regEmail" required
                       class="peer mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 placeholder-transparent"
                       placeholder="Email">
                <label for="regEmail" 
                       class="absolute left-3 -top-2.5 px-1 bg-white text-green-600 text-xs transition-all duration-200 peer-placeholder-shown:text-sm peer-placeholder-shown:text-gray-500 peer-placeholder-shown:top-3 peer-focus:-top-2.5 peer-focus:text-green-600 peer-focus:text-xs">
                    Email
                </label>
            </div>
            <div class="relative">
                <input type="tel" id="regPhone" required
                       class="peer mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 placeholder-transparent"
                       placeholder="Nomor HP">
                <label for="regPhone" 
                       class="absolute left-3 -top-2.5 px-1 bg-white text-green-600 text-xs transition-all duration-200 peer-placeholder-shown:text-sm peer-placeholder-shown:text-gray-500 peer-placeholder-shown:top-3 peer-focus:-top-2.5 peer-focus:text-green-600 peer-focus:text-xs">
                    Nomor HP
                </label>
            </div>
            <div class="relative">
                <input type="password" id="regPassword" required
                       class="peer mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 placeholder-transparent"
                       placeholder="Password">
                <label for="regPassword" 
                       class="absolute left-3 -top-2.5 px-1 bg-white text-green-600 text-xs transition-all duration-200 peer-placeholder-shown:text-sm peer-placeholder-shown:text-gray-500 peer-placeholder-shown:top-3 peer-focus:-top-2.5 peer-focus:text-green-600 peer-focus:text-xs">
                    Password
                </label>
            </div>
            <div>
                <button type="submit" 
                        class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white btn-primary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 relative overflow-hidden group transition-all duration-300 hover:shadow-lg hover:scale-[1.02] active:scale-[0.98]">
                    <span class="relative z-10 flex items-center">
                        <span class="transition-all duration-300 group-hover:pr-2">Daftar Sekarang</span>
                        <i class="fas fa-user-plus ml-0 opacity-0 transform -translate-x-2 transition-all duration-300 group-hover:opacity-100 group-hover:ml-2 group-hover:translate-x-0"></i>
                    </span>
                    <span class="absolute inset-0 bg-white opacity-0 group-hover:opacity-10 transition-opacity duration-500"></span>
                </button>
            </div>
        </form>

        <script>
            // Toggle between login and register forms
            document.getElementById('loginTab').addEventListener('click', function() {
                document.getElementById('loginForm').classList.remove('hidden');
                document.getElementById('registerForm').classList.add('hidden');
                this.classList.add('text-gray-800');
                document.getElementById('registerTab').classList.remove('text-gray-800');
            });

            document.getElementById('registerTab').addEventListener('click', function() {
                document.getElementById('loginForm').classList.add('hidden');
                document.getElementById('registerForm').classList.remove('hidden');
                this.classList.add('text-gray-800');
                document.getElementById('loginTab').classList.remove('text-gray-800');
            });

            // Handle registration
            document.getElementById('registerForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Get form values
                const newCustomer = {
                    id: 'CUST-' + Math.random().toString(36).substr(2, 8).toUpperCase(),
                    name: document.getElementById('regName').value,
                    email: document.getElementById('regEmail').value,
                    phone: document.getElementById('regPhone').value,
                    joinDate: new Date().toISOString(),
                    password: document.getElementById('regPassword').value
                };

                // Save to localStorage
                const customers = JSON.parse(localStorage.getItem('customers')) || [];
                customers.push(newCustomer);
                localStorage.setItem('customers', JSON.stringify(customers));

                // Show success message and clear form
                alert('Pendaftaran berhasil! Silakan login dengan akun Anda.');
                this.reset();
                
                // Switch back to login tab
                document.getElementById('loginTab').click();
                
                // Auto-fill email in login form
                document.getElementById('loginEmail').
                document.getElementById('loginPassword').focus();
            });
        </script>

        <div id="message" class="hidden p-4 text-sm rounded-lg"></div>
    </div>

    <!-- Tambahkan library confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <!-- Tambahkan style animasi -->
    <style>
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }
        .floating {
            animation: float 3s ease-in-out infinite;
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .bouncing {
            animation: bounce 1s infinite;
        }
    </style>


    <script>
        // Initialize sample customers if not exists
        if (!localStorage.getItem('customers')) {
            const sampleCustomers = [
                {
                    id: 'CUST-001',
                    name: 'Budi Santoso',
                    email: 'budi@example.com',
                    phone: '08123456789',
                    joinDate: '2023-01-15'
                },
                {
                    id: 'CUST-002', 
                    name: 'Ani Wijaya',
                    email: 'ani@example.com',
                    phone: '08234567890',
                    joinDate: '2023-02-20'
                }
            ];
            localStorage.setItem('customers', JSON.stringify(sampleCustomers));
        }

        // Toggle customer list
        document.getElementById('showCustomerList').addEventListener('click', () => {
            document.getElementById('customerList').classList.remove('hidden');
            loadCustomerList();
        });

        document.getElementById('closeCustomerList').addEventListener('click', () => {
            document.getElementById('customerList').classList.add('hidden');
        });

        // Load customer list
        function loadCustomerList() {
            const customers = JSON.parse(localStorage.getItem('customers')) || [];
            const container = document.querySelector('#customerList .grid');
            container.innerHTML = '';

            customers.forEach(customer => {
                const card = document.createElement('div');
                card.className = 'bg-white p-4 rounded-lg shadow hover:shadow-md transition-shadow';
                card.innerHTML = `
                    <h4 class="font-bold text-lg">${customer.name}</h4>
                    <p class="text-gray-600 text-sm">${customer.email}</p>
                    <p class="text-gray-600 text-sm">${customer.phone}</p>
                    <p class="text-gray-500 text-xs mt-2">Member sejak: ${new Date(customer.joinDate).toLocaleDateString('id-ID')}</p>
                    <button onclick="loginAsCustomer('${customer.id}')" 
                            class="mt-2 w-full bg-green-100 text-green-800 py-1 px-3 rounded text-sm hover:bg-green-200 transition">
                        Login
                    </button>
                `;
                container.appendChild(card);
            });
        }

        // Login as customer
        function loginAsCustomer(customerId) {
            const customers = JSON.parse(localStorage.getItem('customers'));
            const customer = customers.find(c => c.id === customerId);
            
            if (customer) {
                localStorage.setItem('currentCustomer', JSON.stringify(customer));
                window.location.href = 'dashboard.html';
            }
        }

        // Search functionality
        document.getElementById('searchCustomer').addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase();
            const cards = document.querySelectorAll('#customerList .grid > div');
            
            cards.forEach(card => {
                const text = card.textContent.toLowerCase();
                card.style.display = text.includes(searchTerm) ? 'block' : 'none';
            });
        });
    </script>
    <!-- Load Confetti Library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <!-- Load Auth and CRM -->
    <script src="js/auth.js"></script>
    <script src="js/crm.js"></script>
    <script src="js/new-animations.js"></script>
    
    <script>
      document.getElementById('loginForm').onsubmit = function(e) {
        e.preventDefault();
        const email = document.getElementById('loginEmail').value.trim();
        const password = document.getElementById('loginPassword').value;
        
        if (handleLogin(email, password)) {
          // Verify session before redirect
          if (localStorage.getItem('currentCustomer')) {
            window.location.href = 'dashboard.html';
          } else {
            alert('Gagal membuat sesi login!');
          }
        } else {
          alert('Email atau password salah!');
        }
      };
    </script>
</body>
</html>